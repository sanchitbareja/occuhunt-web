{% extends "base.html" %}
{% load static from staticfiles %}
{% load i18n %}
{% load url from future %}

{% block extra_style %}

<style type="text/css">

.documents {
	margin: 0px;
	padding: 0px;
	list-style-type: none;
}

.document {
	width: 190px;
	height: 260px;
	display: inline-block;
	position: relative;
	clear: none;
	border: 1px solid #dddddd;
	margin-bottom: 30px;
	list-style-type: none;
}

.actions {
	display: block;
	float: left;
	font-family: Arial,"sans-serif";
	font-size: 1.1em;
	position: absolute;
	white-space: nowrap;
	list-style: none;
	margin-top: 3px;
}

.actions > li {
	display: inline;
	margin:10px;
	list-style-type: none;
}

.document:hover {
	border: 1px solid #005469;
}

.document:hover > .actions > li {
	opacity: 1;
}

.file_upload {
	position:absolute;
	z-index:500;
	top:0;
	left:0;
	width: 100%;
	height: 100%;
	float:left;
	filter: alpha(opacity=0);
	-ms-filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";
	opacity:0;
	background-color:transparent;
	color:black;
}

#delete_link {
	color:white;
	opacity: 0.3;
	font-size: 0.9em;
}

#delete_link:hover {
	opacity: 1;
}

</style>

{% endblock %}

{% block extra_script %}

<!-- Date formatting library -->
<script src="http://cdnjs.cloudflare.com/ajax/libs/moment.js/2.1.0/moment.min.js"></script>
<script src="http://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.4.2/underscore-min.js" type="text/javascript"></script>
<script type="text/javascript" src="{% static 'occuhunt/js/lodash.min.js' %}"></script>
<script type="text/javascript" src="{% static 'occuhunt/js/s3upload.js' %}"></script>
<script type="text/javascript" src="{% static 'occuhunt/js/progress-meter.js' %}"></script>
<!-- In production, only one script (pdf.js) is necessary -->
<!-- In production, change the content of PDFJS.workerSrc below -->
<script type="text/javascript" src="{% static 'pdfjs/src/shared/util.js' %}"></script>
<script type="text/javascript" src="{% static 'pdfjs/src/shared/colorspace.js' %}"></script>
<script type="text/javascript" src="{% static 'pdfjs/src/shared/pattern.js' %}"></script>
<script type="text/javascript" src="{% static 'pdfjs/src/shared/function.js' %}"></script>
<script type="text/javascript" src="{% static 'pdfjs/src/shared/annotation.js' %}"></script>
<script type="text/javascript" src="{% static 'pdfjs/src/display/api.js' %}"></script>
<script type="text/javascript" src="{% static 'pdfjs/src/display/metadata.js' %}"></script>
<script type="text/javascript" src="{% static 'pdfjs/src/display/canvas.js' %}"></script>
<script type="text/javascript" src="{% static 'pdfjs/src/display/font_loader.js' %}"></script>

<script type="text/javascript">
  // Specify the main script used to create a new PDF.JS web worker.
  // In production, change this to point to the combined `pdf.js` file.
  PDFJS.workerSrc = '{% static 'pdfjs/src/worker_loader.js' %}';
</script>

<script src="{% static 'occuhunt/js/waypoints.min.js' %}"></script>
<script src="{% static 'occuhunt/js/waypoints-infinite.min.js' %}"></script>
<script src="{% static 'occuhunt/js/profile.js' %}"></script>


{% endblock %}

{% block content %}
<script type="text/javascript" src="{% static 'zeroclipboard/ZeroClipboard.js' %}"></script>

<div class="col-lg-2">
	<div class="text-right">
		<a href="/profile/resumes/" style="border-right: 2px solid #005f69; font-weight:bold;" class="btn btn-link">Resumes and Profile</a><br />
		<a href="/profile/resumes/" class="btn btn-link">Notifications</a>
	</div>
</div>
<div class="col-lg-7">
	<input type="hidden" name="user_linkedin_uid" value="{{user_linkedin_uid}}">

	<!-- This is where the pdf renders -->
    <div class="row" id="canvas_div">
      	<canvas id="the-canvas" style="display:none;" />
	</div>  	
    
    <h4 style="margin-bottom:2px; padding-bottom:2px;">Resumes<br /><span style="font-size:0.6em;"><i>Only companies you apply to can view your resume and CV</i></span></h4>
    
    <ul class="documents" id="resumes">
    	<li class="document">
	      	<a id="file_select_button" href='javascript:;'>
	      		<img style="width:188px; height:258px;" src="http://img.bhs4.com/b7/b/b7b76402439268b532e3429b3f1d1db0b28651d5_large.jpg">
	        	<input type="file" class="file_upload" name="file_source" accept="application/pdf" onchange='render_pdf(1);'>
	      	</a>
    	</li>
    	{% for resume in resumes %}
    	<li class="document">
    		<a href="/document/{{resume.user.username}}/{{resume.unique_hash}}/" target="_blank"><img style="width:100%; height:100%;" src="{{resume.image_url}}"></a>
    		<ul class="actions">
    			<li><a class="viewAnalytics" data-toggle="tooltip" data-placement="top" onclick="get_visits({{resume.id}});"><span class="glyphicon glyphicon-eye-open"></span></a></li>
    			<li><a class="copyToClipboard" data-clipboard-text="http://www.occuhunt.com/document/{{resume.user.username}}/{{resume.unique_hash}}/" data-toggle="tooltip" data-placement="top"><span class="glyphicon glyphicon-link"></span></a></li>
    			<li><a class="deleteResume" data-toggle="tooltip" data-placement="top" onclick="delete_document({{resume.id}}, this);"><span class="glyphicon glyphicon-trash"></span></a></li>
    		</ul>
    	</li>
    	{% endfor %}
    </ul>
    
    <h4>CVs</h4>
    <ul class="documents" id="cvs">
    	<li class="document">
    		<a id="file_select_button" href='javascript:;'>
	      		<img style="width:188px; height:258px;" src="http://img.bhs4.com/b7/b/b7b76402439268b532e3429b3f1d1db0b28651d5_large.jpg">
	        	<input type="file" class="file_upload" name="file_source" accept="application/pdf" onchange='render_pdf(2);'>
	      	</a>
    	</li>
    	{% for cv in cvs %}
    	<li class="document">
    		<a href="/document/{{cv.user.username}}/{{cv.unique_hash}}/"><img style="width:100%; height:100%;" src="{{cv.image_url}}"></a>
    		<ul class="actions">
    			<li><a class="viewAnalytics" data-toggle="tooltip" data-placement="top" onclick="get_visits({{cv.id}});"><span class="glyphicon glyphicon-eye-open"></span></a></li>
    			<li><a class="copyToClipboard" data-clipboard-text="http://www.occuhunt.com/document/{{cv.user.username}}/{{cv.unique_hash}}/" data-toggle="tooltip" data-placement="top"><span class="glyphicon glyphicon-link"></span></a></li>
    			<li><a class="deleteResume" data-toggle="tooltip" data-placement="top" onclick="delete_document({{request.user.id}},{{cv.id}}, this);"><span class="glyphicon glyphicon-trash"></span></a></li>
    		</ul>
    	</li>
    	{% endfor %}
    </ul>

    <h4>Portfolio</h4>
    <ul class="documents" id="portfolio">
    	<li class="document">
    		<a id="file_select_button" href='javascript:;'>
	      		<img style="width:188px; height:258px;" src="http://img.bhs4.com/b7/b/b7b76402439268b532e3429b3f1d1db0b28651d5_large.jpg">
	        	<input type="file" class="file_upload" name="file_source" accept="application/pdf" onchange='render_pdf(3);'>
	      	</a>
	      </li>
    	{% for portfolio in portfolios %}
    	<li class="document">
    		<a href="/document/{{portfolio.user.username}}/{{portfolio.unique_hash}}/"><img style="width:100%; height:100%;" src="{{portfolio.image_url}}"></a>
    		<ul class="actions">
    			<li><a class="viewAnalytics" data-toggle="tooltip" data-placement="top" onclick="get_visits({{portfolio.id}});"><span class="glyphicon glyphicon-eye-open"></span></a></li>
    			<li><a class="copyToClipboard" data-clipboard-text="http://www.occuhunt.com/document/{{portfolio.user.username}}/{{portfolio.unique_hash}}/" data-toggle="tooltip" data-placement="top"><span class="glyphicon glyphicon-link"></span></a></li>
    			<li><a class="deleteResume" data-toggle="tooltip" data-placement="top" onclick="delete_document({{request.user.id}},{{portfolio.id}}, this);"><span class="glyphicon glyphicon-trash"></span></a></li>
    		</ul>
    	</li>
    	{% endfor %}
    </ul>

</div>

<div class="col-lg-3">
	<h4>Links</h4>
	<div id="link_pills">
		{% for link in links %}
			<div class="label label-link"><a style="color:#fdfdfd;" href="{{ link.url }}" target="_blank"><span>{{ link.link_name }}</span></a>&nbsp;<span class="glyphicon glyphicon-remove" id="delete_link" onclick="delete_link({{link.id}},this);"></span></div>
		{% endfor %}
	</div>

	<div id="add_new_link">
		<div style="display:inline-block; padding: 10px 0px;">
			<input class="input-text" id="link_label" style="vertical-align:top; display:inline-block; width:25%;" type="text" placeholder="Label">
			<input class="input-text" id="link_url" style="vertical-align:top; display:inline-block; width:55%;" type="text" placeholder="http://hello.com">
			<button class="btn btn-sm btn-inverted-default" style="vertical-align:bottom; display:inline-block;" onclick="save_new_link(this);"><span class="glyphicon glyphicon-plus"></span></button>
		</div>
	</div>

	<br />
	<h4>Analytics<br /><span style="font-size:0.6em;"><i>Click on a document to get insights</i></span></h4>
	<div style="height:250px;width:100%;" id="map-canvas"></div>
	<div class="list-group" id="visit_notifications">
		<div class="list-group-item" style="color:grey;">			
			<p>Anonymous1 viewed at 5.22pm on May 30th 2014 from San Francisco, CA</p>
		</div>
		<div class="list-group-item" style="color:grey;">			
			<p>Anonymous2 downloaded at 5.22pm on May 30th 2014 from San Francisco, CA</p>
		</div>
		<div class="list-group-item" style="color:grey;">			
			<p>Anonymous2 downloaded at 5.22pm on May 30th 2014 from San Francisco, CA</p>
		</div>
	</div>
	
</div>

{% endblock %}


{% block extra_script_end %}

{% endblock %}